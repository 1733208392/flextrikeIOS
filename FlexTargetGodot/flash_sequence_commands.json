{
  "commands": {
    "ready": {
      "description": "Ready command - Prepares system and spawns target",
      "payload": {
        "action": "netlink_forward",
        "content": {
          "command": "ready",
          "mode": "cqb",
          "targetType": "disguised_enemy"
        },
        "dest": "A"
      },
      "notes": "Must be sent first. Mode and targetType can be customized."
    },
    "animation_config": {
      "description": "Animation config command - Sets the flash_sequence animation",
      "payload": {
        "action": "netlink_forward",
        "content": {
          "command": "animation_config",
          "action": "disguised_enemy_flash",
          "duration": -1.0
        },
        "dest": "A"
      },
      "notes": "Send after ready, before start. Duration -1 uses defaults (3+3=6s total)."
    },
    "animation_config_custom_duration": {
      "description": "Animation config with custom total duration",
      "payload": {
        "action": "netlink_forward",
        "content": {
          "command": "animation_config",
          "action": "disguised_enemy_flash",
          "duration": 10.0
        },
        "dest": "A"
      },
      "notes": "Custom duration overrides sequence timing (advanced usage)"
    },
    "start": {
      "description": "Start command - Begins drill and animation playback",
      "payload": {
        "action": "netlink_forward",
        "content": {
          "command": "start",
          "mode": "cqb",
          "targetType": "disguised_enemy",
          "timeout": 30,
          "delay": 0
        },
        "dest": "A"
      },
      "notes": "Timeout is drill duration in seconds. Delay is before animation starts."
    },
    "start_with_delay": {
      "description": "Start command with animation delay",
      "payload": {
        "action": "netlink_forward",
        "content": {
          "command": "start",
          "mode": "cqb",
          "targetType": "disguised_enemy",
          "timeout": 30,
          "delay": 2
        },
        "dest": "A"
      },
      "notes": "Delay of 2 seconds before animation begins"
    },
    "end": {
      "description": "End command - Completes the drill",
      "payload": {
        "action": "netlink_forward",
        "content": {
          "command": "end"
        },
        "dest": "A"
      },
      "notes": "Send after drill completes or to force stop"
    }
  },
  "sequences": {
    "basic_flash_sequence": {
      "description": "Basic flash_sequence animation workflow",
      "steps": [
        {
          "step": 1,
          "name": "Ready Command",
          "payload": {
            "action": "netlink_forward",
            "content": {
              "command": "ready",
              "mode": "cqb",
              "targetType": "disguised_enemy"
            },
            "dest": "A"
          },
          "wait_after": 1000
        },
        {
          "step": 2,
          "name": "Animation Config Command",
          "payload": {
            "action": "netlink_forward",
            "content": {
              "command": "animation_config",
              "action": "disguised_enemy_flash",
              "duration": -1.0
            },
            "dest": "A"
          },
          "wait_after": 1000
        },
        {
          "step": 3,
          "name": "Start Command",
          "payload": {
            "action": "netlink_forward",
            "content": {
              "command": "start",
              "mode": "cqb",
              "targetType": "disguised_enemy",
              "timeout": 30,
              "delay": 0
            },
            "dest": "A"
          },
          "wait_after": 8000,
          "notes": "Wait 8s for 6s animation + 2s buffer"
        },
        {
          "step": 4,
          "name": "End Command",
          "payload": {
            "action": "netlink_forward",
            "content": {
              "command": "end"
            },
            "dest": "A"
          },
          "wait_after": 0
        }
      ]
    },
    "flash_sequence_with_delay": {
      "description": "Flash sequence with 2-second delay before animation starts",
      "steps": [
        {
          "step": 1,
          "name": "Ready Command",
          "payload": {
            "action": "netlink_forward",
            "content": {
              "command": "ready",
              "mode": "cqb",
              "targetType": "disguised_enemy"
            },
            "dest": "A"
          },
          "wait_after": 1000
        },
        {
          "step": 2,
          "name": "Animation Config Command",
          "payload": {
            "action": "netlink_forward",
            "content": {
              "command": "animation_config",
              "action": "disguised_enemy_flash",
              "duration": -1.0
            },
            "dest": "A"
          },
          "wait_after": 1000
        },
        {
          "step": 3,
          "name": "Start Command (with 2s delay)",
          "payload": {
            "action": "netlink_forward",
            "content": {
              "command": "start",
              "mode": "cqb",
              "targetType": "disguised_enemy",
              "timeout": 30,
              "delay": 2
            },
            "dest": "A"
          },
          "wait_after": 10000,
          "notes": "Wait 10s for 2s delay + 6s animation + 2s buffer"
        },
        {
          "step": 4,
          "name": "End Command",
          "payload": {
            "action": "netlink_forward",
            "content": {
              "command": "end"
            },
            "dest": "A"
          },
          "wait_after": 0
        }
      ]
    }
  },
  "parameters": {
    "mode": {
      "description": "Game mode",
      "values": ["ipsc", "idpa", "cqb"],
      "default": "ipsc",
      "notes": "Must match the target type being used"
    },
    "targetType": {
      "description": "Target scene type",
      "values": ["ipsc", "idpa", "cqb_front", "cqb_moving", "cqb_swing", "cqb_hostage", "disguised_enemy", "hostage"],
      "default": "ipsc",
      "notes": "Must be valid for the selected mode"
    },
    "action": {
      "description": "Animation action name",
      "values": ["flash", "run_through", "run_through_reverse", "swing_left", "swing_right", "up", "down", "disguised_enemy_flash"],
      "default": "flash",
      "notes": "Use 'disguised_enemy_flash' for the flash_sequence animation"
    },
    "duration": {
      "description": "Animation duration in seconds",
      "values": [-1.0, "positive_float"],
      "default": -1.0,
      "notes": "-1.0 uses template default, positive values override"
    },
    "timeout": {
      "description": "Drill timeout in seconds",
      "values": ["positive_integer"],
      "default": 30,
      "notes": "How long the drill runs before auto-completing"
    },
    "delay": {
      "description": "Animation delay in seconds",
      "values": ["non-negative_float"],
      "default": 0,
      "notes": "Wait time before animation starts"
    }
  },
  "animation_details": {
    "disguised_enemy_flash": {
      "type": "flash_sequence",
      "total_duration": 6.0,
      "sequence_steps": [
        {
          "step": 1,
          "scene": "res://scene/targets/disguised_enemy_surrender.tscn",
          "duration": 3.0,
          "description": "Show disguised enemy in surrender pose"
        },
        {
          "step": 2,
          "scene": "res://scene/targets/disguised_enemy.tscn",
          "duration": 3.0,
          "description": "Show disguised enemy in normal pose"
        }
      ],
      "end_behavior": "Stops on last scene (no loop)",
      "hit_detection": "Active on all scenes, signals reconnect on each swap"
    }
  }
}
